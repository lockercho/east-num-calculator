<!DOCTYPE html>
<html>

<head>
    <title>æ±æ–¹éˆæ•¸ï¼ˆå¥½å‘½å¯†ç¢¼ï¼‰è¨ˆç®—æ©Ÿ</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3Y8XCL2WW1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-3Y8XCL2WW1');
    </script>
    <!-- bing search -->
    <meta name="msvalidate.01" content="15E08000B1A2EA68A630CF560DE6CC19" />
    <!-- adsense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3577336627928306"
        crossorigin="anonymous"></script>
    <meta name="description" content="æ¢ç´¢æ±æ–¹éˆæ•¸çš„ç¥ç§˜ä¸–ç•Œï¼Œä½¿ç”¨éˆæ•¸è¨ˆç®—æ©Ÿæ·±å…¥äº†è§£æ‚¨çš„ç”Ÿå‘½æ•¸å­—å’Œé‹å‹¢ï¼Œå¼•å°æ‚¨èµ°å‘æ›´è±ç››çš„äººç”Ÿã€‚ç¥ä»™è£œç¿’ç­è…¦ç²‰è¬¹è£½ã€‚(æ±æ–¹éˆæ•¸ / å¥½å‘½å¯†ç¢¼ / æ•¸å­—æ˜“ç¶“)">
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<style>
    p,
    div,
    input,
    button {
        font-size: 20px;
    }

    body {
        background-color: #fffaf0;
    }

    table,
    th,
    td {
        border: 1px solid black;

    }

    th,
    td {
        padding: 2px 20px;
    }

    .hide {
        display: none;
    }

    .striked {
        text-decoration: line-through;
    }

    .free-input-label {
        padding: 5px 10px;
        font-size: 20px;
    }

    button {
        margin: 0 10px 0 0;
    }

    .gray {
        color: gray;
        font-style: italic;
    }

    .callout {
        --bs-link-color-rgb: var(--bd-callout-link);
        --bs-code-color: var(--bd-callout-code-color);
        padding: 1.25rem;
        margin-top: 1.25rem;
        margin-bottom: 1.25rem;
        color: var(--bd-callout-color, inherit);
        background-color: var(--bd-callout-bg, var(--bs-gray-100));
        border-left: 0.25rem solid var(--bd-callout-border, var(--bs-gray-300));
    }

    .btn-light {
        margin: 10px 0;
        border: 1px solid hsl(0deg, 0%, 86%)
    }

    .btn {
        margin-right: 10px;
    }

    h1 {
        padding-top: 20px;
    }

    input {
        vertical-align: middle;
    }

    header {
        margin-bottom: 20px;
    }

    #result-free-stats {
        margin-bottom: 40px;
    }
</style>

<body class="container">
    <header>
        <h1>æ±æ–¹éˆæ•¸è¨ˆç®—å™¨</h1>
    </header>
    <div class="card">
        <div class="card-body">
            <h3 style="color: blue">åš´æ­£è²æ˜ï¼š</h3>
            <h4>æœ¬ç¶²ç«™æ‰€æœ‰åŠŸèƒ½ç‚ºã€Œå…è²»ã€ä½¿ç”¨ï¼Œä¹Ÿåƒ…æä¾›ã€Œéç‡Ÿåˆ©ã€ä½¿ç”¨ã€‚</h4>
            <h4>çŸ¥è­˜ä¾†æºç‚ºã€Œç¥ä»™è£œç¿’ç­ã€ä»‹ç´¹çš„ã€Œæ±æ–¹éˆæ•¸ã€ã€‚</h4>
            <h4>æˆ‘å€‘æ²’æœ‰è·Ÿä»»ä½•å–®ä½åˆä½œæ”¶è²»ï¼Œä¹Ÿæ²’æœ‰é–‹è¨­ä»»ä½• Line ç¾¤ / IG / Facebook ç¾¤çµ„ï¼Œè«‹æ…é˜²è©é¨™ã€‚</h4>
        </div>
    </div>
    <div><br>è¨ˆç®—æ‰€è¼¸å…¥æ•¸å­—çš„æ±æ–¹éˆæ•¸<br>ï¼ˆç”Ÿæ°£ã€å¤©é†«ã€å»¶å¹´ã€ä¼ä½ã€çµ•å‘½ã€äº”é¬¼ã€å…­ç…ã€ç¦å®³ï¼‰</div>
    <p><br>æ•¸å­—æ„ç¾©è§£èªªè«‹çœ‹ï¼š<a target="_blank"
            href="https://docs.google.com/spreadsheets/u/0/d/18McHGqDtBXo3KZub1rwe8vI3SGXFI7lctMWY9U6yl4c/htmlview">æ±æ–¹éˆæ•¸
            åˆ†äº«ç‰ˆ </a></p>
    <!-- Section 1 -->
    <div class="card">
        <div class="card-body">
            <h2 class="card-title">åˆ†æ1ï¼šäººæ ¼é¡å‹+äººç”Ÿå¤§é‹</h2>
            <p for="numberInput">è«‹è¼¸å…¥èº«åˆ†è­‰å­—è™Ÿï¼š</p>
            <input autofocus type="text" id="numberInput" onkeydown="if(event.keyCode == 13){calculateID()}"
                style="font-size: 20px;">
            <button class="btn btn-light" onclick="calculateID()">è¨ˆç®—</button>

            <p id="recap-input"></p>
            <p id="result-overall-type"></p>
            <p id="result-yearly-fortune"></p>
        </div>
    </div>
    <hr />
    <!-- Section 2 -->
    <div class="card">
        <div class="card-body">
            <h2 class="card-title">åˆ†æ2ï¼šä¸€çµ„æ•¸å­—ï¼ˆæ‰‹æ©Ÿã€è»Šç‰Œã€ä½å€ç­‰ï¼‰</h2>
            <p>
                è‹¥é‡åˆ°è‹±æ–‡ï¼Œæœƒä¾ç…§A=01, B=02, ... çš„è¦å‰‡è½‰æ›
                <br />éè‹±æ–‡æˆ–æ•¸å­—çš„ç¬¦è™Ÿæœƒè¢«è·³é
            </p>

            <p>åœ°å€ä¹Ÿå¯ï¼Œä½†æ•¸å­—è«‹ä½¿ç”¨åŠå‹é˜¿æ‹‰ä¼¯æ•¸å­—ï¼Œä¾‹å¦‚ 100å°åŒ—å¸‚ä¸­æ­£å€é‡æ…¶å—è·¯1æ®µ122è™Ÿ</p>
            <h4 for="numberInputAny">è«‹è¼¸å…¥ä¸€ä¸²è‹±æ•¸å­—ï¼š</h4>
            <input type="text" id="numberInputAny" onkeydown="if(event.keyCode == 13){calculateAny()}"
                style="font-size: 20px;">
            <button class="btn btn-light" onclick="calculateAny()">è¨ˆç®—</button>
            <p id="recap-input-2"></p>
            <p id="result-any"></p>
            <p id="result-any-stats"></p>
        </div>
    </div>
    <hr />
    <!-- Section 3 -->
    <div class="card" id="section-3">
        <div class="card-body">
            <h2 class="card-title">åˆ†æ3ï¼šå¤šçµ„æ•¸å­—</h2>
            <p>
                èº«åˆ†è­‰å­—è™Ÿ / æ‰‹æ©Ÿ / è»Šç‰Œ / ä½å€ / å…¶ä»–æ•¸å­—ç­‰å¤šçµ„ä¸€èµ·è¨ˆç®—ã€‚<br>
                çœ‹ç›¸äº’æŠµéŠ·å¾Œæœ€å¾Œæ˜¯å“ªäº›éˆæ•¸ã€‚
            </p>
            <div class="free-input">
                <input type="text" id="free-input" onkeydown="if(event.keyCode == 13){transformInputToLabel()}"
                    style="font-size: 20px;">
                <button class="btn btn-light" onclick="transformInputToLabel()">æ–°å¢</button>
            </div>
            <div id="free-input-labels">
            </div>
            <p id="recap-free-input"></p>
            <p id="result-free-stats"></p>
            <p id="result-free"></p>

        </div>
    </div>
    <hr />
    <!-- Other notes -->
    <div class="card" id="tips">
        <div class="card-body">
            <h2>æ•¸å­—åŒ–è§£å£è¨£</h2>
            <p>å»ºè­°ç”±ç²—é«”å­—é–‹å§‹ä½¿ç”¨</p>
            <p>
                <u>å¤©é†«</u> æ¬º <u>çµ•å‘½</u>ï¼šçœ‹åˆ°è‡ªå·±æœ‰çµ•å‘½ï¼Œè«‹ç”¨å¤©é†«åŒ–è§£ (<strong>13, 31, 68, 86</strong>, 49, 94, 72, 27)<br>
                <u>å»¶å¹´</u> å£“ <u>å…­ç…</u>ï¼šçœ‹åˆ°è‡ªå·±æœ‰å…­ç…ï¼Œè«‹ç”¨å»¶å¹´åŒ–è§£ (<strong>19, 91, 87, 78</strong>, 34, 43, 26, 62)<br>
                <u>ç”Ÿæ°£</u> è£œ <u>ç¦å®³</u>ï¼šçœ‹åˆ°è‡ªå·±æœ‰ç¦å®³ï¼Œè«‹ç”¨ç”Ÿæ°£åŒ–è§£ (<strong>14, 41, 76, 67</strong>, 93, 39, 82, 28)<br>
                <u>ç”Ÿæ°£+å¤©é†«+å»¶å¹´</u> åŒ– <u>äº”é¬¼</u> (é †åºä¸å¯è®Š)<br>
                <br>
                ä¸ç¢ºå®šæ•¸å­—è£œå‡ºäº†ä»€éº¼å¯ä»¥ç”¨ä¸Šé¢çš„ <strong>åˆ†æ3</strong> æŸ¥è©¢
            </p>
        </div>
    </div>
    <hr />
    <p>
        åƒè€ƒè³‡æ–™:
    <ul>
        <li><a target="_blank"
                href="https://docs.google.com/spreadsheets/u/0/d/18McHGqDtBXo3KZub1rwe8vI3SGXFI7lctMWY9U6yl4c/htmlview">
                æ±æ–¹éˆæ•¸è§£é‡‹ åˆ†äº«ç‰ˆ ï¼ˆ \æ„Ÿè¬ç¤¾ç¾¤/ ï¼‰ </a></li>
        <li><a target="_blank" href="https://www.chinyuan.com.tw/all_book/more?id=4878"> å¥½å‘½å¯†ç¢¼ - æ•¸å­—ç£å ´çš„é­…åŠ› </a></li>
        <li><a target="_blank" href="https://www.youtube.com/watch?v=7__exuY_6Bg"> ç¥ä»™è£œç¿’ç­ - æ±æ–¹éˆæ•¸ </a></li>
        <li> <a target="_blank" href="https://www.instagram.com/p/C2RWknTP7ce/"> ç¥ä»™è£œç¿’ç­ ig </a></li>
    </ul>
    </p>
    <hr />
    <p>
        ä½œè€…èªªæ˜å€ (2024/5/17 update):
    <ul>
        <li>ç¶²ç«™ä¸æœƒæœé›†è³‡æ–™ï¼Œè«‹å®‰å¿ƒé¤µå„ç¨®æ•¸å­—ã€‚</li>
        <li>è¿‘æ—¥æœ‰æ–°èè¸¢çˆ†æœ‰æ‰“è‘—æ•¸å­—æ˜“ç¶“/æ±æ–¹éˆæ•¸çš„è©é¨™ç¾¤çµ„ã€‚</li>
        <li>æˆ‘ä¹Ÿä¸€åº¦è€ƒæ…®æ˜¯å¦é—œé–‰ç¶²ç«™ï¼Œä¸è¦æˆç‚ºè©é¨™é›†åœ˜çš„å¹«å…‡ã€‚</li>
        <li>ä½†å°±åƒé–‹é ­èªªçš„ï¼Œæœ¬ç¶²ç«™å¹«åŠ©å¸Œæœ›è—‰ç”±æ±æ–¹éˆæ•¸æ”¹å–„ç”Ÿæ´»çš„äººã€‚å¦‚æœå°±æ­¤é—œé–‰ï¼Œæ˜¯æœ¬æœ«å€’ç½®ã€å› å™å»¢é£Ÿã€‚</li>
        <li>èº«ç‚ºä¸€å€‹ç›¸ä¿¡é–‹æºæœƒè®“ä¸–ç•Œæ›´ç¾å¥½çš„å·¥ç¨‹å¸«ï¼Œç¶²ç«™æœƒç¹¼çºŒç¶­æŒç‡Ÿé‹ï¼Œä¹Ÿæœƒä¸€ç›´å…è²»ã€‚</li>
    </ul>
    <hr>
    <p style="display: none;">1413191</p>
    <p style="display: none;">$$$$$</p>
    <p>å¦‚æœé€™å€‹å…è²»å·¥å…·æœ‰å¹«åŠ©åˆ°ä½ ã€ä½ ä¹Ÿæ”¯æŒé–‹æ”¾ä¸–ç•Œã€æˆ–å–®ç´”æƒ³è«‹æˆ‘å–<span style="display: none;">1413191</span>æ¯å’–å•¡ï¼Œé€™é‚Šé–‹æ”¾éš¨å–œæŠ–å…§ğŸ’°ï¼š<br>
        <table>
            <tbody>
                <tr>
                    <td>ğŸ’° Richart (812) 2888-10024-39067<br><br>
                    <img src="richart.PNG" width="250" alt=""/>
                    <p style="display: none;">1413191</p>
                    <p style="display: none;">$$$$$</p>
                    </td>
                    <td>
                        <br>
                        ğŸ’° Line bank (824) 111-0182-62978<br><br>
                    <img src="linebank.jpg" width="250" alt=""/>
                    <p style="display: none;">1413191</p>
                    <p style="display: none;">$$$$$</p>
                    </td>
                </tr>
            </tbody>
        </table>
        
        ç¥çœ‹åˆ°é€™è£¡çš„äººå¥½é‹æ—ºæ—ºï¼Œä¸€åˆ‡çš„å®‰æ’éƒ½ä»¥æœ€é«˜æœ€ç¾å¥½ç™¼ç”Ÿã€‚<br>
    </p>
    <p style="display: none;">$$$$$</p>
    <p style="display: none;">1413191</p>
    </p>
    <input style="display: none;" id="hidden-input" />

</body>

</html>
<script>
    function convertToAlphabeticalOrder(letter) {
        var lowercaseLetter = letter.toLowerCase();
        var alphabeticalOrder = lowercaseLetter.charCodeAt(0) - 96;
        if (alphabeticalOrder > 26 || alphabeticalOrder < 1) {
            return null;
        }
        return alphabeticalOrder.toString().padStart(2, '0');
    }

    function skipNonHalfWidthNumbers(value) {
        var newValue = "";
        for (var i = 0; i < value.length; i++) {
            var code = value.charCodeAt(i);
            if (code >= 48 && code <= 57) {
                newValue += value.charAt(i);
            } else {
                var tmp = convertToAlphabeticalOrder(value.charAt(i))
                if (tmp != null) {
                    newValue += tmp;
                }
            }
        }
        return newValue
    }


    function parse05(value, keep5) {
        var v = value.split("");
        var newValue = "";
        for (var i = 0; i < v.length; i++) {
            if (v[i] == '5' && i > 0 && i < v.length - 1 && keep5 == false) {
                // skip middle 5
                continue
            }
            newValue += v[i];
        }
        return newValue;
    }

    function getIDInput() {
        return skipNonHalfWidthNumbers(document.getElementById("numberInput").value);
    }
    function getAnyInput() {
        return skipNonHalfWidthNumbers(document.getElementById("numberInputAny").value);
    }
    var explanation = '<div><br>é¡å‹èªªæ˜:<br>';
    explanation += '<li>ï¼ˆ1ï¼‰ç”±[ä¼ä½] ä»£æ›æˆçš„å…¶ä»–éˆæ•¸ï¼Œæœƒé¡¯ç¤ºç‚ºç°è‰²æ–œç·š</li>';
    explanation += '<li>ï¼ˆ2ï¼‰[ä¼ä½] æœƒå»¶çºŒå‰é¢çš„æ•¸å­—èƒ½é‡</li>';
    explanation += '<li>ï¼ˆ3ï¼‰[ç”Ÿæ°£] ä¹Ÿæœƒæ”¾å¤§å‰é¢æ•¸å­—èƒ½é‡</li>';
    explanation += '<li>ï¼ˆ4ï¼‰æ¯”ä¾‹è¦è¦–æ•¸å­—å¼·å¼±ç¨‹åº¦ä¸‹èª¿</li ></div>';

    function calculateID() {
        var numberForOverall = getIDInput()
        var numberForYearly = getIDInput()

        var namesCount = {};

        // show overall type
        var overallNum = numberForOverall
        if (numberForOverall.slice(0, 1) == '0') {
            overallNum = numberForOverall.slice(1)
        }
        console.log("overallNum", overallNum)


        var resDom = document.getElementById("result-overall-type")
        var pairs = calculate(overallNum)
        console.log("pairs", pairs)
        if (pairs.length == 0) {
            resDom.innerHTML = "è¼¸å…¥å¤ªçŸ­ï¼Œé ˆç‚º2ç¢¼ä»¥ä¸Šè‹±æ•¸å­—"
            return
        }
        var { numbersLine, namesLine, namesCount, totalNames, table, realSeq } = createViewFromPairs(pairs);
        resDom.innerHTML = '<h4>é¡å‹ï¼š</h4>'
        resDom.innerHTML += "ä½¿ç”¨ï¼š<u>" + overallNum + "</u> (æ­¤é …ä¸çœ‹é–‹é ­0) <br> ";
        var { result, stats } = calOverallType(namesCount, totalNames)
        resDom.innerHTML += numbersLine + '<br>' + namesLine + "<br>"
        resDom.innerHTML += stats + "<br><br>" + result
        resDom.innerHTML += explanation;

        // show yearly fortune
        var resDom = document.getElementById("result-yearly-fortune")
        var { numbersLine, namesLine, namesCount, totalNames, table, realSeq } = createViewFromPairs(calculate(numberForYearly));
        resDom.innerHTML = '<h4>äººç”Ÿå¤§é‹ï¼š</h4>'
        resDom.innerHTML += "<div>"
        resDom.innerHTML += "å¤§é‹ä½¿ç”¨ï¼š<u>" + numberForYearly + "</u><br>";
        resDom.innerHTML += numbersLine + '<br>' + namesLine + "<br>"
        resDom.innerHTML += "</div>"
        resDom.innerHTML += "<br>"
        resDom.innerHTML += table;
    }

    function calculateAny() {
        var number = getAnyInput()
        var inputNumber = "æ‚¨è¼¸å…¥çš„æ•¸å­—ç‚ºï¼š<u>" + number + "</u>";

        var namesCount = {};

        var resDom = document.getElementById("recap-input-2")
        var pairs = calculate(number)
        if (pairs == false) {
            resDom.innerHTML = "è¼¸å…¥å¤ªçŸ­ï¼Œé ˆç‚º2ç¢¼ä»¥ä¸Šè‹±æ•¸å­—"
            return
        }
        resDom.innerHTML = ''
        resDom.innerHTML += inputNumber

        var resDom = document.getElementById("result-any")
        var { numbersLine, namesLine, namesCount, totalNames, table, realSeq } = createViewFromPairs(pairs);
        resDom.innerHTML = numbersLine + '<br>' + namesLine + "<br>"

        var resDom = document.getElementById("result-any-stats")
        var { result, stats } = calOverallType(namesCount, totalNames)
        resDom.innerHTML = stats
    }

    var labelIDIncrement = 0;
    var hideIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-slash-fill" viewBox="0 0 16 16"><path d="m10.79 12.912-1.614-1.615a3.5 3.5 0 0 1-4.474-4.474l-2.06-2.06C.938 6.278 0 8 0 8s3 5.5 8 5.5a7 7 0 0 0 2.79-.588M5.21 3.088A7 7 0 0 1 8 2.5c5 0 8 5.5 8 5.5s-.939 1.721-2.641 3.238l-2.062-2.062a3.5 3.5 0 0 0-4.474-4.474z"/><path d="M5.525 7.646a2.5 2.5 0 0 0 2.829 2.829zm4.95.708-2.829-2.83a2.5 2.5 0 0 1 2.829 2.829zm3.171 6-12-12 .708-.708 12 12z"/></svg>';
    var showIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye-fill" viewBox="0 0 16 16"><path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0"/><path d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8m8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7"/></svg>';
    var copyIcon = '<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-copy" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 2a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm2-1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 5a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-1h1v1a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h1v1z"/></svg>';
    function transformInputToLabel() {
        var newInput = document.getElementById("free-input").value
        var resDom = document.getElementById("recap-free-input")
        var pairs = calculate(newInput)
        if (pairs == false) {
            resDom.innerHTML = "è¼¸å…¥å¤ªçŸ­ï¼Œé ˆç‚º2ç¢¼ä»¥ä¸Šè‹±æ•¸å­—"
            return false
        }
        // Add label
        var labelDom = document.getElementById("free-input-labels")
        var labelHTML = '<div id="free-div-' + labelIDIncrement + '">'
        labelHTML += '<span class="free-input-label" id="free-label-' + labelIDIncrement + '">'
        labelHTML += newInput
        labelHTML += '</span>'
        labelHTML += '<button class="btn btn-light" id="hide-button-' + labelIDIncrement + '" onclick="hideFree(' + labelIDIncrement + ')">' + hideIcon + ' éš±è—</button>'
        labelHTML += '<button class="btn btn-light hide" id="show-button-' + labelIDIncrement + '" onclick="showFree(' + labelIDIncrement + ')">' + showIcon + ' é¡¯ç¤º</button>'
        labelHTML += '<button class="btn btn-light" id="copy-button-' + labelIDIncrement + '" onclick="copyFree(' + labelIDIncrement + ')">' + copyIcon + ' è¤‡è£½</button>'
        labelHTML += '<button class="btn btn-danger" onclick="deleteFree(' + labelIDIncrement + ')">åˆªé™¤</button>'
        labelHTML += '</div>'
        labelIDIncrement++
        labelDom.innerHTML += labelHTML
        document.getElementById("free-input").value = ""
        calculateFree()
    }
    function hideFree(id) {
        // add strike to label
        // hide 'hide' button
        // show 'show' button
        document.getElementById("free-label-" + id).classList.add("striked")
        document.getElementById("hide-button-" + id).classList.add("hide")
        document.getElementById("show-button-" + id).classList.remove("hide")
        calculateFree()
    }
    function showFree(id) {
        // remove strike to label
        // show 'hide' button
        // hide 'show' button
        document.getElementById("free-label-" + id).classList.remove("striked")
        document.getElementById("hide-button-" + id).classList.remove("hide")
        document.getElementById("show-button-" + id).classList.add("hide")
        calculateFree()
    }
    function copyFree(id) {
        var str = document.getElementById("free-label-" + id).innerText;
        var input = document.getElementById("hidden-input");
        input.value = str;
        input.select();
        document.execCommand("copy");
        navigator.clipboard.writeText(str)
        // document.querySelector("#free-label-" + id).select()
        // document.execCommand("copy")
    }
    function deleteFree(id) {
        document.getElementById("free-div-" + id).remove()
        calculateFree()
    }

    function getFreeInputLabels() {
        var nodeList = document.querySelectorAll('.free-input-label')
        var res = []
        for (var i = 0; i < nodeList.length; i++) {
            if (!nodeList[i].classList.contains("striked")) {
                res.push(skipNonHalfWidthNumbers(nodeList[i].innerText))
            }
        }
        return res;
    }
    function payoffFiveGhost(sequence, payOffCount, allNamesCount) {
        for (var i = 0; i < sequence.length - 2; i++) {
            var n1 = sequence[i]
            var n2 = sequence[i + 1]
            var n3 = sequence[i + 2]
            if (payOffCount > 0 && n1 === 'ç”Ÿæ°£' && n2 === 'å¤©é†«' && n3 === 'å»¶å¹´') {
                sequence[i] = '';
                sequence[i + 1] = '';
                sequence[i + 2] = '';
                allNamesCount[n1]--;
                allNamesCount[n2]--;
                allNamesCount[n3]--;
                payOffCount--;
            }
        }
        return {
            newSequence: sequence.filter(function (v) { return v !== '' }),
            payOffCount
        }
    }
    function payoffOthers(sequence, target, payOffCount, allNamesCount) {
        var mapping = {
            'çµ•å‘½': 'å¤©é†«', 'å…­ç…': 'å»¶å¹´', 'ç¦å®³': 'ç”Ÿæ°£'
        }
        for (var i = 0; i < sequence.length; i++) {
            var n1 = sequence[i]
            if (payOffCount > 0 && n1 === mapping[target]) {
                sequence[i] = '';
                allNamesCount[n1]--;
                payOffCount--;
            }
        }
        return {
            newSequence: sequence.filter(function (v) { return v !== '' }),
            payOffCount
        }
    }
    function calculateFree() {
        var numbers = getFreeInputLabels() // Todo
        var allPairs = []
        var allPairsForPayoff = []
        var viewPairs = []
        var allNamesCount = {}
        var allTotalNames = 0
        console.log(numbers)
        var allNamesLine = ""

        for (var i = 0; i < numbers.length; i++) {
            pairs = calculate(numbers[i])
            allPairs = allPairs.concat(pairs)
            var { numbersLine, namesLine, namesCount, totalNames, table, realSeq } = createViewFromPairs(pairs);
            allPairsForPayoff.push(realSeq)
            allTotalNames += totalNames
            // merge dict
            for (var key in namesCount) {
                if (allNamesCount[key]) {
                    allNamesCount[key] += namesCount[key]
                } else {
                    allNamesCount[key] = namesCount[key]
                }
            }
            allNamesLine += numbersLine + '<br>' + namesLine + "<br>"
        }
        console.log("test allPairsForPayoff", allPairsForPayoff)
        console.log("allNamesCount", allNamesCount)

        // Payoff good and bad
        if (allNamesCount['äº”é¬¼'] > 0) {
            for (var i = 0; i < allPairsForPayoff.length; i++) {
                var sequence = allPairsForPayoff[i]
                var { newSequence, payOffCount } = payoffFiveGhost(sequence, allNamesCount['äº”é¬¼'], allNamesCount)
                console.log("payOffCount123", payOffCount)
                allPairsForPayoff[i] = newSequence
                allNamesCount['äº”é¬¼'] = payOffCount
                if (payOffCount == 0) {
                    break
                }
            }
        }
        console.log("after 5 ghost", allPairsForPayoff)
        var others = ["ç¦å®³", "å…­ç…", "çµ•å‘½"]
        others.map(function (target) {
            if (!allNamesCount[target]) {
                return
            }
            console.log("after 5 ghost qweqew", allPairsForPayoff)
            for (var i = 0; i < allPairsForPayoff.length; i++) {
                var sequence = allPairsForPayoff[i]
                var { newSequence, payOffCount } = payoffOthers(sequence, target, allNamesCount[target], allNamesCount)
                allPairsForPayoff[i] = newSequence
                allNamesCount[target] = payOffCount
                if (allNamesCount[target] == 0) {
                    break
                }
            }
        })
        console.log("allPairsForPayoff", allPairsForPayoff)
        console.log("allNamesCount", allNamesCount)

        // Show final result
        var resDom = document.getElementById("result-free")
        resDom.innerHTML = allNamesLine

        console.log(allNamesCount, allTotalNames)
        // Show paid off result
        var resDom = document.getElementById("result-free-stats")
        var totalCount = Object.keys(allNamesCount).reduce(function (acc, key) {
            return acc + allNamesCount[key];
        }, 0);
        if (totalCount === 0) {
            resDom.innerHTML = '<h3>å°çµ</h3 >'
            resDom.innerHTML += "å‰æ•¸å‡¶æ•¸å…¨éƒ¨æŠµéŠ·ã€‚"
            return
        }
        var { result, stats } = calOverallType(allNamesCount, totalCount)
        resDom.innerHTML = '<h3>å°çµ</h3 >'
        resDom.innerHTML += stats
    }


    function ht5(number) {
        // heading & tailing 5
        for (var i = 0; i < number.length; i++) {
            if (number[i] != '5') {
                break
            }
            number[i] = '0'
        }
        // heading & tailing 5
        for (var i = number.length - 1; i >= 0; i--) {
            if (number[i] != '5') {
                break
            }
            number[i] = '0'
        }
        // middle 5
        for (var i = 0; i < number.length; i++) {
            var n0 = i > 0 ? number[i - 1] : false;
            var n1 = number[i];
            // find first non-5
            var n2 = '0'
            for (var j = i + 1; j < number.length; j++) {
                if (number[j] != '5') {
                    n2 = number[j]
                    break
                }
            }
            if (n1 === '5' && (n0 === '0' || n2 === '0')) {
                number[i] = '0'
            }
        }
        return number
    }

    function ht0(number) {
        // get first non-zero number
        var saved = false;
        for (var i = 0; i < number.length; i++) {
            if (number[i] != '0') {
                saved = number[i];
                break
            }
        }
        if (saved === false) {
            // All zero
            return number
        }
        // replace heading 0
        for (var i = 0; i < number.length; i++) {
            if (number[i] != '0') {
                break
            }
            number[i] = saved
        }
        // replace middle 0
        saved = false
        for (var i = 0; i < number.length; i++) {
            if (number[i] != '0') {
                saved = number[i];
            } else {
                number[i] = saved
            }
        }
        return number
    }

    function _calculate(number) {
        if (number.length < 2) {
            return []
        }

        if (typeof number === 'string') {
            number = number.split('')
        }
        number = ht5(number)
        // console.log(number)
        number = ht0(Array.from(number))

        // duplicate 5
        var nSeries = []
        for (var i = 0; i < number.length; i++) {
            var n0 = i > 0 ? number[i - 1] : false;
            var n1 = number[i];
            if (n1 == '5') {
                // calculate successive 5
                var tailNum = false;
                for (var j = i; j < number.length; j++) {
                    if (number[j] != '5') {
                        tailNum = number[j]
                        break
                    }
                }
                for (var k = 0; k < j - i + 1; k++) {
                    if (k > 0) { nSeries.push(n0) }

                    if (k != j - i) {
                        nSeries.push(tailNum)
                    }
                }
                // all 5 handled
                i = j - 1
                continue
            }
            nSeries.push(n1)
        }
        return nSeries
    }


    function _getPairs(number) {
        var resultPairs = [];
        for (var i = 0; i < number.length - 1; i++) {
            resultPairs.push(number[i] + number[i + 1])
        }
        return resultPairs
    }

    function calculate(number) {
        number = _calculate(number)
        return _getPairs(Array.from(number))
    }

    function createViewFromPairs(pairs) {
        numbersLine = pairs.map(function (pair) {
            return "<u>" + toFullWidth(pair) + "</u> ";
        }).join(" ")
        namesLine = pairs.map(function (pair) {
            return "<span>" + getNumberName(pair) + "</span> ";
        }).join(" ")
        table = "<table><thead><tr><th>éšæ®µ</th><th>æ•¸å­—</th></tr></thead><tbody>";
        table += pairs.map(function (pair, i) {
            return "<tr><td>" + getStage(i, pairs.length) + "</td><td>" + getNumberName(pair) + "</td></tr>"
        }).join("")
        table += "</tbody></table>";

        var namesCount = {};
        var totalNames = 0;
        var prevNoneLay = 'ä¼ä½';
        var realSeq = []

        for (var i = 0; i < pairs.length; i++) {
            var n = getNumberName(pairs[i])
            console.log(i, n, prevNoneLay)
            if (n == "ä¼ä½") {
                // Count the occurrence of each name
                if (namesCount[prevNoneLay]) {
                    namesCount[prevNoneLay]++;
                } else {
                    namesCount[prevNoneLay] = 1;
                }
                realSeq.push(prevNoneLay)
                totalNames++;
                continue
            }
            prevNoneLay = n

            // Count the occurrence of each name
            if (namesCount[n]) {
                namesCount[n]++;
            } else {
                namesCount[n] = 1;
            }
            realSeq.push(n)
            totalNames++;
        }
        var realNamesLine = realSeq.map(function (name, idx) {
            if (getNumberName(pairs[idx]) == "ä¼ä½" && name != "ä¼ä½") {
                return '<span class="gray">' + name + "</span> ";
            }
            return "<span>" + name + "</span> ";
        }).join(" ")
        namesLine = realNamesLine // test
        return {
            numbersLine: numbersLine,
            namesLine: namesLine,
            namesCount: namesCount,
            totalNames: totalNames,
            table: table,
            realSeq: realSeq
        }
    }


    function getStage(i, total) {
        var arr = [
            "0~10æ­²", // 0
            "11~15æ­²", // 1
            "16~20æ­²", // 2
            "21~25æ­²", // 3
            "26~30æ­²", // 4
            "31~35æ­²", // 5
            "36~40æ­²", // 6
            "41~45æ­²", // 7
            "46~50æ­²", // 8
            "51~70æ­²", // 9
            "71~90æ­²",
            "91~110æ­²",
            "111~130æ­²",
        ]
        var arr2 = [
            "51~60æ­²",
            "61~70æ­²",
            "71~80æ­²",
            "81~90æ­²",
            "91~100æ­²",
            "101~110æ­²",
            "111~120æ­²",
            "121~130æ­²",
        ]
        if (i > 8 && total > 10) {
            return arr2[i - 9]
        }
        if (i >= arr.length)
            return "ERROR"
        return arr[i]
    }

    function calOverallType(namesCount, totalNames) {
        // Create items array
        var sortedNames = Object.keys(namesCount).map(function (key) {
            if (namesCount[key] == 0) {
                return false
            }
            // key, count, percentage
            return [key, namesCount[key], namesCount[key] / totalNames];
        }).filter(function (v) { return v !== false });
        // Sort the array based on the second element
        sortedNames = sortedNames.sort(function (first, second) {
            return second[1] - first[1];
        });
        var result = "æ‚¨ç‚ºã€Œ<strong>" + sortedNames[0][0] + "</strong>ã€å‹çš„äºº<br>";
        var stats = sortedNames.map(function (v) {
            return v[0] + ": " + v[1] + " (" + (v[2] * 100).toFixed(1) + "%)";
        }).join(", ")
        return { result, stats }
    }

    function toFullWidth(str) {
        var fullWidth = "";
        for (var i = 0; i < str.length; i++) {
            var code = str.charCodeAt(i);
            if (code >= 48 && code <= 57) {
                fullWidth += String.fromCharCode(code + 65248);
            } else {
                fullWidth += str.charAt(i);
            }
        }
        return fullWidth;
    }

    function getNumberName(pair) {
        switch (pair) {
            case "17":
            case "71":
            case "89":
            case "98":
            case "46":
            case "64":
            case "23":
            case "32":
                return "ç¦å®³";
            case "16":
            case "61":
            case "47":
            case "74":
            case "38":
            case "83":
            case "92":
            case "29":
                return "å…­ç…";
            case "18":
            case "81":
            case "79":
            case "97":
            case "42":
            case "24":
            case "36":
            case "63":
                return "äº”é¬¼";
            case "12":
            case "21":
            case "96":
            case "69":
            case "84":
            case "48":
            case "73":
            case "37":
                return "çµ•å‘½";
            case "00":
            case "11":
            case "22":
            case "33":
            case "44":
            case "55":
            case "66":
            case "77":
            case "88":
            case "99":
                return "ä¼ä½";
            case "19":
            case "91":
            case "87":
            case "78":
            case "34":
            case "43":
            case "26":
            case "62":
                return "å»¶å¹´";
            case "13":
            case "31":
            case "68":
            case "86":
            case "49":
            case "94":
            case "72":
            case "27":
                return "å¤©é†«";
            case "14":
            case "41":
            case "76":
            case "67":
            case "93":
            case "39":
            case "82":
            case "28":
                return "ç”Ÿæ°£";
            default:
                return "ï¼¸ï¼¸";
        }
    }
</script>